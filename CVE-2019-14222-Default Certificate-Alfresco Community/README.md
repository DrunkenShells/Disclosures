# CVE-2019-14222: Alfresco Default Certificate

Alfresco Community instalations, versions 6.0 and lower, come installed with static SSL certificates.
<br/>
These certificates are used in 2 ways:
- Authenticating to the Solr Admin Web Interface
- Encrypting Client-Server traffic 

### Authenticating to the Solr Admin Web Interface

The [browser.p12](browser.p12), with password "alfresco", file can be installed in a browser in order to authenticate via X509 Mutual Authentication Protocol.  
<br/>
<strong>Note:</strong> As and alternative, if the public certificates have been modified, but the private key was kept the same, one can use the [alfresco.rsa](alfresco.rsa) private key in burp in order to forcefully authenticate using this private key.
<br/>

#### STEPS:
1. Import [browser.p12](browser.p12), with password "alfresco", in your browser of choice (In this case Firefox).
1. Navigate to URL "/solr4/" of a victim with Alfresco Community installed
1. Use the imported certificate to authenticate to Solr
<img src="Browser Send Cert Auth.png">
4. Get access to Alfresco's Solr Web Admin Interface
<img src="Auth to Solr.png">

### Decrypting Client-Server traffic

By knowing the private key used by Alfresco to encrypt HTTP traffic, [alfresco.rsa](alfresco.rsa), an attacker may leverege it to launch:
- Active Man-in-the-Middle Attacks using a valid certificate
- Passive Decrytion (if non-Perfect Forwarding Secrecy (PFS) encryption ciphers are used)

#### Example Passive Decryption

1. Capture/Obtain Client-Server traffic
1. Decrypt the traffic using the [alfresco.rsa](alfresco.rsa) private key
<img src="Server Cipher.png">
<img src="Decrypt Communication.png">

