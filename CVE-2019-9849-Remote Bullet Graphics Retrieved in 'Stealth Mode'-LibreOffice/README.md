# CVE-2019-9849: Remote Bullet Graphics Retrieved in 'Stealth Mode'

LibreOffice has a 'stealth mode' in which only documents from locations deemed 'trusted' are allowed to retrieve remote resources.
<br/>
This mode is not the default mode, but can be enabled by users who want to disable LibreOffice's ability to include remote resources within a document.
<br/>
A flaw existed where bullet graphics were omitted from this protection prior to version 6.2.5.
<br/>

<table>
	<tr>
		<th>HTML Tag</th>
		<th>HTML Attribute</th>
		<th>Triggers When Opened</th>
		<th>Triggers On Save/Export</th>
	</tr>
	<tr>
		<td><strong>ol</strong></td>
		<td><strong>src</strong></td>
		<td>No</td>
		<td>Yes</td>
	</tr>	
	<tr>
		<td><strong>ul</strong></td>
		<td><strong>src</strong></td>
		<td>No</td>
		<td>Yes</td>
	</tr>	
</table>

### Proof Of Concept:

The vulnerability is only triggered when "Saving" and/or "Exporting" the below HTML file using the following formats:
- Save As - OTH (Makes 2 Requests: OPTIONS + GET / per tag)
- Export – ODT (Makes 2 Requests: OPTIONS + GET / per tag)
- Export – SXW (Makes 1 GET Request / per tag)

##### File "ol-ul.html":

```
<ol src="http://localhost:8000/?ssrf=ol_src">
<ul src="http://localhost:8000/?ssrf=ul_src">
```

##### Save As - OTH

<img src="Save%20As%20-%20OTH.png">
<br/>
<img src="Save%20As%20-%20OTH%20Result.png">

##### Export - ODT

<img src="Export%20-%20ODT.png">
<br/>
<img src="Export%20-%20ODT%20Result.png">

##### Export - SXW

<img src="Export%20-%20SXW.png">
<br/>
<img src="Export%20-%20SXW%20Result.png">

